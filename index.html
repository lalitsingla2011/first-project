<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Sora:wght@400;600;700;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<div class="search-bar-wrap" id="search-bar-wrap">
  <div class="search-bar-inner">
    <span class="search-icon">üîç</span>
    <input type="text" id="global-search" placeholder="Search dashboard..." autocomplete="off"
      oninput="onSearchInput(this.value)" onkeydown="onSearchKey(event)"/>
    <button class="search-clear" id="search-clear" onclick="clearSearch()">‚úï</button>
  </div>
  <div class="search-results" id="search-results"></div>
</div>
<button id="settings-btn" onclick="toggleSettings()" title="Settings">‚öôÔ∏è</button>
<button id="theme-toggle" onclick="toggleTheme()" title="Toggle theme">üåô Dark</button>

<!-- Settings Panel -->
<div id="settings-panel" class="settings-panel">
  <div class="settings-section">
    <div class="settings-title">Background</div>
    <label class="settings-label">Solid Colour</label>
    <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px">
      <input type="color" id="bg-color-picker" value="#0d0d12" onchange="applyBgSolid(this.value)"/>
      <span style="font-size:11px;color:var(--muted)">Pick a colour</span>
    </div>
    <label class="settings-label">Gradient Presets</label>
    <div class="bg-presets">
      <div class="bg-swatch" style="background:linear-gradient(135deg,#667eea,#764ba2)" onclick="applyBgGradient('linear-gradient(135deg,#667eea,#764ba2)')"></div>
      <div class="bg-swatch" style="background:linear-gradient(135deg,#f093fb,#f5576c)" onclick="applyBgGradient('linear-gradient(135deg,#f093fb,#f5576c)')"></div>
      <div class="bg-swatch" style="background:linear-gradient(135deg,#4facfe,#00f2fe)" onclick="applyBgGradient('linear-gradient(135deg,#4facfe,#00f2fe)')"></div>
      <div class="bg-swatch" style="background:linear-gradient(135deg,#43e97b,#38f9d7)" onclick="applyBgGradient('linear-gradient(135deg,#43e97b,#38f9d7)')"></div>
      <div class="bg-swatch" style="background:linear-gradient(135deg,#fa709a,#fee140)" onclick="applyBgGradient('linear-gradient(135deg,#fa709a,#fee140)')"></div>
      <div class="bg-swatch" style="background:linear-gradient(135deg,#a18cd1,#fbc2eb)" onclick="applyBgGradient('linear-gradient(135deg,#a18cd1,#fbc2eb)')"></div>
    </div>
    <label class="settings-label">Image URL</label>
    <div style="display:flex;gap:8px;margin-bottom:10px">
      <input type="text" id="bg-image-url" placeholder="https://example.com/image.jpg" style="flex:1;font-size:12px"/>
      <button class="btn" style="padding:7px 12px;font-size:11px" onclick="applyBgImage()">Set</button>
    </div>
    <button class="btn" style="width:100%;background:var(--surface2);color:var(--text2);font-size:11px;padding:7px" onclick="resetBg()">Reset Background</button>
  </div>
  <div class="settings-section">
    <div class="settings-title">Data Backup</div>
    <button class="btn" style="width:100%;font-size:12px;padding:8px;margin-bottom:8px" onclick="exportData()">Export All Data</button>
    <label class="btn" style="width:100%;display:block;text-align:center;background:var(--surface2);color:var(--text2);font-size:12px;padding:8px;cursor:pointer">
      Import Data
      <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(event)"/>
    </label>
  </div>
</div>
<div class="grid">

  <!-- CLOCK + QUOTE -->
  <div class="card c-clock">
    <div class="card-header">
      <div class="card-label">Time & Quote</div>
      <button class="btn-expand" onclick="expandWidget('clock')" title="Expand">‚§¢</button>
    </div>
    <div id="clock-time">00:00:00</div>
    <div id="clock-date"></div>
    <div id="clock-greeting"></div>
    <hr class="clock-quote-divider"/>
    <div class="clock-quote-mark">"</div>
    <div id="clock-quote-text">Loading quote‚Ä¶</div>
    <div id="clock-quote-author" style="display:none"></div>
  </div>

  <!-- WEATHER -->
  <div class="card c-weather">
    <div class="card-header">
      <div class="card-label" id="weather-label">Weather ¬∑ London</div>
      <button class="btn-expand" onclick="expandWidget('weather')" title="Expand">‚§¢</button>
    </div>
    <div id="weather-city-row" style="display:flex;gap:8px;margin-bottom:14px;flex-shrink:0">
      <input type="text" id="weather-city-input" placeholder="Enter city name..." style="flex:1" value="London"/>
      <button class="btn" style="padding:9px 14px;font-size:12px" onclick="changeWeatherCity()">Go</button>
    </div>
    <div id="weather-content"><span style="color:var(--muted);font-size:13px">Fetching weather...</span></div>
  </div>

  <!-- GMAIL -->
  <div class="card c-gmail">
    <div class="card-header">
      <div class="card-label">Gmail ‚Äî Inbox<span class="unread-badge" id="unread-badge" style="display:none">0</span></div>
      <button class="btn-refresh" id="gmail-refresh" onclick="refreshGmail()" title="Refresh emails">‚Üª</button>
      <button class="btn-expand" onclick="expandWidget('gmail')" title="Expand">‚§¢</button>
    </div>

    <div id="gmail-setup" class="setup-notice">
      <div class="si">üì¨</div>
      <p>Connect Gmail to see colour-coded emails here.<br/><strong>Uses your Google API key</strong> ‚Äî already set up.</p>
      <button class="btn-connect" onclick="startGoogleAuth()">Connect Google</button>
    </div>

    <div id="gmail-connected">
      <!-- Category tabs -->
      <div class="email-tabs" id="email-tabs">
        <button class="email-tab tab-all active" onclick="setEmailTab('all')">All <span class="tab-count" id="tc-all">0</span></button>
        <button class="email-tab tab-work"     onclick="setEmailTab('work')"><span class="tab-dot" style="background:var(--work)"></span>Work <span class="tab-count" id="tc-work">0</span></button>
        <button class="email-tab tab-social"   onclick="setEmailTab('social')"><span class="tab-dot" style="background:var(--social)"></span>Social <span class="tab-count" id="tc-social">0</span></button>
        <button class="email-tab tab-shopping" onclick="setEmailTab('shopping')"><span class="tab-dot" style="background:var(--shopping)"></span>Shopping <span class="tab-count" id="tc-shopping">0</span></button>
        <button class="email-tab tab-finance"  onclick="setEmailTab('finance')"><span class="tab-dot" style="background:var(--finance)"></span>Finance <span class="tab-count" id="tc-finance">0</span></button>
        <button class="email-tab tab-other"    onclick="setEmailTab('other')"><span class="tab-dot" style="background:var(--muted)"></span>Other <span class="tab-count" id="tc-other">0</span></button>
      </div>
      <div class="email-scroll" id="gmail-emails">
        <div class="list-empty">Loading emails...</div>
      </div>
    </div>
  </div>

  <!-- GOOGLE CALENDAR -->
  <div class="card c-calendar">
    <div class="card-header">
      <div class="card-label">Google Calendar ‚Äî Today</div>
      <button class="btn-refresh" id="calendar-refresh" onclick="refreshCalendar()" title="Refresh calendar">‚Üª</button>
      <button class="btn-expand" onclick="expandWidget('calendar')" title="Expand">‚§¢</button>
    </div>

    <div id="gcal-setup" class="setup-notice">
      <div class="si">üìÖ</div>
      <p>Connect Google Calendar to see today's events.<br/><strong>Same connection as Gmail</strong> ‚Äî one click.</p>
      <button class="btn-connect" onclick="startGoogleAuth()">Connect Google</button>
    </div>

    <div id="gcal-connected">
      <div class="cal-scroll" id="gcal-events">
        <div class="list-empty">Loading events...</div>
      </div>
    </div>
  </div>

  <!-- TO-DO -->
  <div class="card c-todo">
    <div class="card-header">
      <div class="card-label">To-Do</div>
      <button class="btn-expand" onclick="expandWidget('todo')" title="Expand">‚§¢</button>
    </div>
    <div class="input-row">
      <input type="text" id="todo-input" placeholder="Add a task..." maxlength="80"/>
      <select id="todo-priority">
        <option value="low">Low</option>
        <option value="medium" selected>Medium</option>
        <option value="high">High</option>
      </select>
      <input type="date" id="todo-due"/>
      <button class="btn" onclick="addTodo()">Add</button>
    </div>
    <div class="item-scroll" id="todo-list"></div>
  </div>

  <!-- MANUAL REMINDERS -->
  <div class="card c-reminder">
    <div class="card-header">
      <div class="card-label">Reminders</div>
      <button class="btn-expand" onclick="expandWidget('reminder')" title="Expand">‚§¢</button>
    </div>
    <div class="reminder-inputs">
      <input type="text"           id="r-title" placeholder="Reminder title..." maxlength="60"/>
      <input type="datetime-local" id="r-date"/>
      <button class="btn" onclick="addReminder()">Add Reminder</button>
    </div>
    <div class="item-scroll" id="reminder-list"></div>
  </div>

  <!-- POMODORO TIMER -->
  <div class="card c-pomodoro">
    <div class="card-header">
      <div class="card-label">Pomodoro Timer</div>
      <button class="btn-expand" onclick="expandWidget('pomodoro')" title="Expand">‚§¢</button>
    </div>
    <div class="pomo-mode" id="pomo-mode">Work</div>
    <div class="pomo-display" id="pomo-display">25:00</div>
    <div class="pomo-sessions" id="pomo-sessions">Sessions: 0</div>
    <div class="pomo-controls">
      <button class="btn" id="pomo-start" onclick="pomoStartPause()">Start</button>
      <button class="btn" style="background:var(--surface2);color:var(--text2)" onclick="pomoReset()">Reset</button>
    </div>
    <div class="pomo-config">
      <label>Work <input type="number" id="pomo-work-min" value="25" min="1" max="90" onchange="pomoUpdateConfig()"/>m</label>
      <label>Break <input type="number" id="pomo-break-min" value="5" min="1" max="30" onchange="pomoUpdateConfig()"/>m</label>
    </div>
  </div>

  <!-- NEWS / RSS FEED -->
  <div class="card c-news">
    <div class="card-header">
      <div class="card-label">News</div>
      <button class="btn-refresh" id="news-refresh" onclick="refreshNews()" title="Refresh">‚Üª</button>
      <button class="btn-expand" onclick="expandWidget('news')" title="Expand">‚§¢</button>
    </div>
    <div class="news-config-row" id="news-config-row" style="display:none">
      <input type="text" id="rss-url-input" placeholder="RSS feed URL..."/>
      <button class="btn" style="padding:7px 12px;font-size:12px" onclick="saveRssUrl()">Save</button>
    </div>
    <div class="news-scroll" id="news-list">
      <div class="list-empty">Loading news...</div>
    </div>
    <button class="btn" style="width:100%;background:var(--surface2);color:var(--text2);font-size:11px;padding:6px;margin-top:8px" onclick="toggleRssConfig()">Change Feed</button>
  </div>

</div>

<!-- NOTES (pinned bottom) -->
<div class="card c-notes">
  <div class="card-header">
    <div class="card-label">Notes</div>
    <button id="notes-preview-btn" class="btn-preview" onclick="toggleNotesPreview()">Preview</button>
    <button class="btn-expand" onclick="expandWidget('notes')" title="Expand">‚§¢</button>
  </div>
  <div class="input-row">
    <input type="text" id="note-title-input" placeholder="Note title..." maxlength="80"/>
    <button class="btn" onclick="addNote()">Add Note</button>
  </div>
  <textarea id="notes-area" placeholder="Select a note or add a new one..."></textarea>
  <div id="notes-preview" class="notes-preview" style="display:none"></div>
  <div class="notes-status" id="notes-status"></div>
  <div class="item-scroll" id="notes-list"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="script.js"></script>


<div id="notif-container"></div>

<!-- ‚îÄ‚îÄ WIDGET OVERLAY ‚îÄ‚îÄ -->
<div class="widget-overlay" id="widget-overlay" onclick="closeWidget(event)">
  <div class="widget-expanded" id="widget-expanded">
    <div class="widget-expanded-header">
      <div class="widget-expanded-title" id="widget-expanded-title"></div>
      <button class="modal-close" onclick="closeWidget()">‚úï</button>
    </div>
    <div class="widget-expanded-body" id="widget-expanded-body"></div>
  </div>
</div>

<!-- ‚îÄ‚îÄ EMAIL READER MODAL ‚îÄ‚îÄ -->
<div class="email-modal-backdrop" id="email-modal-backdrop" onclick="closeEmailModal(event)">
  <div class="email-modal" id="email-modal">
    <div class="modal-header">
      <div class="modal-header-top">
        <div class="modal-subject" id="modal-subject"></div>
        <button class="btn-maximise" id="btn-maximise" onclick="toggleMaximise()" title="Maximise">‚§°</button>
        <button class="modal-close" onclick="closeEmailModal()">‚úï</button>
      </div>
      <div class="modal-from" id="modal-from"></div>
      <div class="modal-meta">
        <span class="modal-date" id="modal-date"></span>
        <span class="modal-cat-badge" id="modal-badge"></span>
      </div>
    </div>
    <div class="modal-body" id="modal-body">
      <div class="modal-loading">Loading email‚Ä¶</div>
    </div>
  </div>
</div>
</body>
</html>
